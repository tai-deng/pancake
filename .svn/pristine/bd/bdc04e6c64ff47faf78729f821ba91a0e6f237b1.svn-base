{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\shopping/assets\\Script\\shopping\\ShopMod.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\shopping","sourcesContent":["\r\nimport StateManage from \"../StateManage/StateManage\";\r\nimport ShowJson from \"./ShopJson\";\r\nimport ShopItem from \"./ShopItem\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ShopMod extends cc.Node {\r\n    private static _instance:ShopMod = null;\r\n    public static get instance():ShopMod {\r\n        if (!ShopMod._instance) ShopMod._instance = new ShopMod();\r\n        return ShopMod._instance;\r\n    }\r\n\r\n    constructor(){\r\n        super();\r\n        this.getData();\r\n    }\r\n\r\n    // 渲染页面的数据\r\n    private _potList:Array<object> = [];\r\n    private _pancakeList:Array<object> = [];\r\n    // json 数据\r\n    private sumPotRes = new ShowJson().pot;\r\n    private sumCakeRes = new ShowJson().cake;\r\n    // 用户使用数据 - 存本地\r\n    private _potStore:Array<object> = [];\r\n    private _cakeStore:Array<object> = [];\r\n    // Tab true 锅 false 饼\r\n    public isTab:boolean = true;\r\n\r\n    // 第一次初始化数据\r\n    private initData(){\r\n        for(let i = 0;i < this.sumPotRes.length; ++i){\r\n            let shopItem = this.initNewItem(i,this.sumPotRes)\r\n            this._potList.push(shopItem);\r\n        }\r\n        for(let i = 0;i < this.sumCakeRes.length; ++i){\r\n            let shopItem = this.initNewItem(i,this.sumCakeRes)\r\n            this._pancakeList.push(shopItem);\r\n        }\r\n    }\r\n    // 获取仓库数据\r\n    private getData(){\r\n        let data = StateManage.instance.getData(StateManage.KEY_SHOPDATA);\r\n        if(JSON.stringify(data) == \"{}\"){\r\n            this.initData();\r\n        }else{\r\n            this._potStore = data[\"potSkin\"];\r\n            this._cakeStore = data[\"cakeSkin\"];\r\n            this._potList = this.updaNewItem(this._potStore,this._potList);\r\n            this._pancakeList = this.updaNewItem(this._cakeStore,this._pancakeList);\r\n        }\r\n    }\r\n    // 序列化每一个商品\r\n    private initNewItem(index:number,res:Array<object>):object{\r\n        let shopItem = new ShopItem();\r\n        shopItem.id = index;\r\n        shopItem.skinsRes = res[index];\r\n        shopItem.price = res[index][\"price\"];\r\n        if(index == 0){\r\n            shopItem.isBuy = true;\r\n            shopItem.isUse = true;\r\n            shopItem.waitBuy = true;\r\n            shopItem.newPro = false;\r\n        }else if(index == 1){\r\n            shopItem.isBuy = false;\r\n            shopItem.isUse = false;\r\n            shopItem.waitBuy = true;\r\n            shopItem.newPro = true;\r\n        }else{\r\n            shopItem.isBuy = false;\r\n            shopItem.isUse = false;\r\n            shopItem.waitBuy = false;\r\n            shopItem.newPro = false;\r\n        }\r\n        return shopItem;\r\n    }\r\n    // 把缓存里的用户使用信息更新出来\r\n    private updaNewItem(storageRes:Array<object>,newRes:Array<object>):Array<object>{\r\n        for(let i = 0;i < newRes.length;i++){\r\n            for(let j = 0; j < storageRes.length;j++){\r\n                if(storageRes[j][\"id\"] == newRes[i][\"id\"]){\r\n                    newRes[i] = storageRes[i]\r\n                }\r\n            }\r\n        }\r\n        return newRes;\r\n    }\r\n    // 获取锅数据\r\n    public getPotList():Array<any> {\r\n        return this._potList.concat();\r\n    }\r\n    // 获取饼数据\r\n    public getCakeList(){\r\n        return this._pancakeList.concat();\r\n    }\r\n    // 购买锅皮肤\r\n    public buyShopPot(current:object){\r\n        let updatePot = [];\r\n        this._potList.forEach(function(ele,ind) {\r\n            // 待解锁改成 已解锁,已购买,取消新品  下个商品改成 待解锁 未购买 新品\r\n            ele[\"isUse\"] = false;\r\n\r\n            if(current[\"isBuy\"]){\r\n                if(!current[\"isUse\"]){\r\n                    current[\"isUse\"] = true;\r\n                }\r\n            }else if(current[\"waitBuy\"]){\r\n                current[\"isBuy\"] = true;\r\n                current[\"isUse\"] = true;\r\n                current[\"iswaitBuy\"] = true;\r\n                current[\"newPRO\"] = false;\r\n            }\r\n            if(ele[\"id\"] == current[\"id\"]){\r\n                ele = current;\r\n                if(this._potList.length > ind+1){\r\n                    this._potList[ind+1][\"isBuy\"] = false;\r\n                    this._potList[ind+1][\"isUse\"] = false;\r\n                    this._potList[ind+1][\"waitBuy\"] = true;\r\n                    this._potList[ind+1][\"newPro\"] = true;\r\n                }\r\n            }\r\n        }.bind(this));\r\n        this._potStore = this.updateLocality(this._potStore,updatePot);\r\n        this.dispatchEvent(new cc.Event(\"potDataChanged\", false));\r\n    }\r\n    // 购买饼皮肤\r\n    public buyShopCake(current:object){\r\n        cc.log(current,this._pancakeList,\"被点击的ITEM\")\r\n        let updateCake = [];\r\n        this._pancakeList.forEach(function(ele,ind) {\r\n            // 待解锁改成 已解锁,已购买,取消新品  下个商品改成 待解锁 未购买 新品\r\n            ele[\"isUse\"] = false;\r\n            \r\n            if(current[\"isBuy\"]){\r\n                if(!current[\"isUse\"]){\r\n                    current[\"isUse\"] = true;\r\n                }\r\n            }else if(current[\"waitBuy\"]){\r\n                current[\"isBuy\"] = true;\r\n                current[\"isUse\"] = true;\r\n                current[\"iswaitBuy\"] = true;\r\n                current[\"newPRO\"] = false;\r\n            }\r\n            if(ele[\"id\"] == current[\"id\"]){\r\n                ele = current;\r\n                if(this._pancakeList.length > ind+1){\r\n                    this._pancakeList[ind+1][\"isBuy\"] = false;\r\n                    this._pancakeList[ind+1][\"isUse\"] = false;\r\n                    this._pancakeList[ind+1][\"waitBuy\"] = true;\r\n                    this._pancakeList[ind+1][\"newPro\"] = true;\r\n                }\r\n            }\r\n        }.bind(this));\r\n        this._pancakeList = this.updateLocality(this._pancakeList,updateCake);\r\n        this.dispatchEvent(new cc.Event(\"cakeDataChanged\", false));\r\n    }\r\n    // USE 锅皮肤\r\n    public usePot(current:object){\r\n        let updatePot = [];\r\n        this._potList.forEach(function(ele,ind) {\r\n            ele[\"isUse\"] = false;\r\n            if(current[\"isBuy\"]){\r\n                if(!current[\"isUse\"]){\r\n                    current[\"isUse\"] = true;\r\n                }\r\n            }\r\n            if(ele[\"id\"] == current[\"id\"]){\r\n                ele = current;\r\n            }\r\n        }.bind(this));\r\n        this._potStore = this.updateLocality(this._potStore,updatePot);\r\n        this.dispatchEvent(new cc.Event(\"potDataChanged\", false));\r\n    }\r\n    // USE 饼皮肤\r\n    public useCake(current:object){\r\n        let updateCake = [];\r\n        this._pancakeList.forEach(function(ele,ind) {\r\n            ele[\"isUse\"] = false;\r\n            if(current[\"isBuy\"]){\r\n                if(!current[\"isUse\"]){\r\n                    current[\"isUse\"] = true;\r\n                }\r\n            }\r\n            if(ele[\"id\"] == current[\"id\"]){\r\n                ele = current;\r\n            }\r\n        }.bind(this));\r\n        this._pancakeList = this.updateLocality(this._pancakeList,updateCake);\r\n        this.dispatchEvent(new cc.Event(\"cakeDataChanged\", false));\r\n    }\r\n    // 更新本地缓存数据\r\n    private updateLocality(locRes:Array<object>,newRes:Array<object>):Array<object>{\r\n        for(let i =0;i < locRes.length;i++){\r\n            for(let j = 0;j < newRes.length;j++){\r\n                if(locRes[i][\"id\"] == newRes[j]){\r\n                    locRes[i] = newRes[j];\r\n                }\r\n            }\r\n        }\r\n        return locRes\r\n    }\r\n    // 更新仓库数据\r\n    public updateData(){\r\n        let temp ={};\r\n        temp['potSkin'] = this._potStore;\r\n        temp['cakeSkin'] = this._cakeStore;\r\n        StateManage.instance.setData(StateManage.KEY_SHOPDATA,temp);\r\n    }\r\n}\r\n"]}