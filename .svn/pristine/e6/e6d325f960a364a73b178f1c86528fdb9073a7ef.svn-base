{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\commands/assets\\Script\\commands\\Action.ts"],"names":[],"mappings":";;;;;AACA,+BAA0B;AAE1B,0DAAqD;AACrD,2CAAqC;AAE/B,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAQ,CAAkB;AAC1C,SAAS;AAET;IAAoC,0BAAY;IADhD;QAAA,qEAmFC;QA/EG,aAAO,GAAkB,EAAE,CAAC;QAE5B,aAAO,GAAW,IAAI,CAAC;QAEvB,SAAG,GAAW,IAAI,CAAC;QAEnB,YAAM,GAAW,IAAI,CAAC;QAEf,WAAK,GAAW,IAAI,CAAC;QACpB,iBAAW,GAAW,KAAK,CAAC;;IAsExC,CAAC;IApEG,uBAAM,GAAN;QACI,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;IACD,uBAAM,GAAN,UAAQ,EAAE;QACN,IAAI,IAAI,CAAC,WAAW,EAAE;YACnB,IAAI,CAAC,QAAQ,EAAE,CAAC;SAClB;QACF,IAAI,CAAC,KAAK,EAAE,CAAC;IAChB,CAAC;IACD,sBAAK,GAAL;QACI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;QACjF,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;IACjF,CAAC;IACD,2BAAU,GAAV;QAAA,iBAYC;QAXG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC,QAAQ,CAAC;QAChE,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;QACjF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;QACjG,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QACtE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;QAEjD,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAA,OAAO;YACxB,IAAI,IAAI,GAAG,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAA;YAC7C,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;YACnC,IAAI,CAAC,cAAc,GAAG,KAAI,CAAC,cAAc,CAAC;QAC9C,CAAC,CAAC,CAAC;IACP,CAAC;IACO,+BAAc,GAAtB,UAAuB,OAAyB,EAAC,YAA+B,EAAC,aAAgC;QAC7G,IAAI,GAAG,GAAU,aAAa,CAAC,KAAK,CAAC,CAAC;QACtC,OAAO;QACP,IAAG,GAAG,IAAI,GAAG,EAAC;YACV,OAAO,CAAC,QAAQ,GAAG,IAAI,CAAC;YAExB,qBAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,qBAAW,CAAC,eAAe,EAAC,CAAC,CAAC,CAAC;YAE5D,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM;gBAAE,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,gBAAK,CAAC,CAAC,MAAM,EAAE,CAAC;SACrE;QACD,wBAAwB;QACxB,IAAG,GAAG,IAAI,GAAG,EAAE;YACX,wCAAwC;YAExC,IAAI,KAAK,GAAG,MAAM,CAAC,qBAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,qBAAW,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,CAAC;YAC7E,qBAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,qBAAW,CAAC,SAAS,EAAC,KAAK,CAAC,CAAC;YAC1D,qBAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,qBAAW,CAAC,eAAe,EAAC,CAAC,CAAC,CAAC;SAC/D;IACL,CAAC;IACD,OAAO;IACA,yBAAQ,GAAf;QACI,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;IAC1G,CAAC;IACD,SAAS;IACF,sBAAK,GAAZ;QACI,IAAG,IAAI,CAAC,KAAK,EAAC;YACV,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,qBAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,qBAAW,CAAC,SAAS,CAAC,CAAC;SAClG;QACD,IAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,EAAC;YACf,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,cAAc,EAAE,CAAC;YACvE,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,cAAc,EAAE,CAAC;YACnE,IAAG,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAC,EAAE,IAAI,IAAI,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAC,GAAG,IAAI,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,GAAC,GAAG,EAAC;gBAC5D,cAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;aACxB;SACJ;IACL,CAAC;IACO,kCAAiB,GAAzB,UAA0B,CAAU;QAChC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;IAC5B,CAAC;IACO,gCAAe,GAAvB,UAAwB,CAAU;QAC9B,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;IAC7B,CAAC;IA9ED;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;2CACU;IAE5B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;2CACK;IAEvB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;uCACC;IAEnB;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;0CACI;IATL,MAAM;QAD1B,OAAO;OACa,MAAM,CAkF1B;IAAD,aAAC;CAlFD,AAkFC,CAlFmC,EAAE,CAAC,SAAS,GAkF/C;kBAlFoB,MAAM","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\commands","sourcesContent":["import GameManager from \"../gamecore/managers/GameManager\";\r\nimport Over from \"./Over\";\r\nimport Game from \"../Game/Game\";\r\nimport StateManage from \"../StateManage/StateManage\";\r\nimport Jewel from \"../Jewels/Jewels\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n// 手臂类执行体\r\n@ccclass\r\nexport default class Action extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    pancake:Array<cc.Node> = [];\r\n    @property(cc.Node)\r\n    terrace:cc.Node = null;\r\n    @property(cc.Node)\r\n    arm:cc.Node = null;\r\n    @property(cc.Node)\r\n    jewels:cc.Node = null;\r\n\r\n    public score:cc.Node = null;\r\n    private _isTouching:boolean = false;\r\n\r\n    onLoad(){\r\n        this.initialize();\r\n    }\r\n    update (dt) {\r\n        if (this._isTouching) {\r\n           this.strength();\r\n        }\r\n       this.crash();\r\n    }\r\n    start(){\r\n        this.node.parent.on(cc.Node.EventType.TOUCH_START, this.touchStartHandler, this);\r\n        this.node.parent.on(cc.Node.EventType.TOUCH_END, this.touchEndHandler, this);\r\n    }\r\n    initialize():void{\r\n        this.pancake = this.node.getChildByName(\"pancakeNode\").children;\r\n        this.score = this.node.parent.getChildByName(\"describe\").getChildByName(\"score\");\r\n        this.terrace = this.node.getChildByName(\"hands\").getChildByName(\"pot\").getChildByName(\"terrace\");\r\n        this.arm = this.node.getChildByName(\"hands\").getChildByName(\"bigArm\");\r\n        this.jewels = this.node.getChildByName(\"jewels\");\r\n\r\n        this.pancake.forEach(element => {\r\n            let temp = element.getComponent(cc.RigidBody)\r\n            temp.enabledContactListener = true;\r\n            temp.onBeginContact = this.onBeginContact;\r\n        });\r\n    }\r\n    private onBeginContact(contact:cc.PhysicsContact,selfCollider:cc.PhysicsCollider,otherCollider:cc.PhysicsCollider){\r\n        let tag:number = otherCollider[\"tag\"];\r\n        // 碰撞到锅\r\n        if(tag != 100){\r\n            contact.disabled = true;\r\n\r\n            StateManage.instance.setData(StateManage.KEY_JEWEL_STATE,1);\r\n\r\n            if (!this.jewels.active) this.jewels.getComponent(Jewel).create();\r\n        }\r\n        // 碰撞到钻石,加上当前砖石分数,重新生成钻石\r\n        if(tag == 200 ){\r\n            // otherCollider[\"node\"].active = false;\r\n\r\n            let score = Number(StateManage.instance.getData(StateManage.KEY_SCORE)) + 50;\r\n            StateManage.instance.setData(StateManage.KEY_SCORE,score);\r\n            StateManage.instance.setData(StateManage.KEY_JEWEL_STATE,1);\r\n        }\r\n    }\r\n    // 加力动作\r\n    public strength(){\r\n        this.arm.getComponent(cc.RigidBody).applyLinearImpulse(new cc.Vec2(1000, 0), new cc.Vec2(0, 0), true);\r\n    }\r\n    //over 检测\r\n    public crash(){\r\n        if(this.score){\r\n            this.score.getComponent(cc.Label).string = StateManage.instance.getData(StateManage.KEY_SCORE);\r\n        }\r\n        if(this.pancake[5]){\r\n            let pans = this.pancake[5].getComponent(cc.RigidBody).getWorldCenter();\r\n            let pot = this.terrace.getComponent(cc.RigidBody).getWorldCenter();\r\n            if(pans.y < pot.y-50 && pans.x < pot.x+188 && pot.x > pot.x-188){\r\n                Over.instance.show();\r\n            }\r\n        }\r\n    }\r\n    private touchStartHandler(e:cc.Event):void {\r\n        this._isTouching = true;\r\n    }\r\n    private touchEndHandler(e:cc.Event):void {\r\n        this._isTouching = false;\r\n    }\r\n}\r\n"]}