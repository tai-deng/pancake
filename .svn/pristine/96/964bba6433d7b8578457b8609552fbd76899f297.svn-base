{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\gameScene/assets\\Script\\gameScene\\ActionMain.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\gameScene","sourcesContent":["import GameManager from \"../gamecore/managers/GameManager\";\r\nimport GameSceneEvents from \"./GameSceneEvents\";\r\nimport GameEventNames from \"../GameEventNames\";\r\nimport DiamondMain from \"./DiamondMain\";\r\nimport PancakeMain from \"./PancakeMain\";\r\nimport PancakeStates from \"./PancakeStates\";\r\nimport GameData from \"../GameData\";\r\nimport LevelData from \"./LevelData\";\r\nimport GameConfig from \"../GameConfig\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n\r\n// 手臂类执行体\r\n@ccclass\r\nexport default class ActionMain extends cc.Component {\r\n\r\n    //油喷溅特效\r\n    @property(cc.Prefab)\r\n    oilEffectPrefab:cc.Prefab = null;\r\n\r\n    //煎饼初始化时，离锅底的距离\r\n    public cakeInitDistance:number = 300;\r\n\r\n    //钻石预制体\r\n    @property(cc.Prefab)\r\n    diamondPrefab:cc.Prefab = null;\r\n\r\n    //煎饼预制体\r\n    @property(cc.Prefab)\r\n    pancakePrefab:cc.Prefab = null;\r\n    \r\n    //钻石容器\r\n    @property(cc.Node)\r\n    diamondContainer:cc.Node = null;\r\n    \r\n    //锅底碰撞体\r\n    @property({\r\n        type:cc.Node,\r\n        displayName:\"锅底\"\r\n    })\r\n    panBottomNode:cc.Node = null;\r\n\r\n    //手臂1段\r\n    @property(cc.Node)\r\n    theArm1:cc.Node = null;\r\n    //手臂2段\r\n    @property(cc.Node)\r\n    theArm2:cc.Node = null;\r\n    //手臂3段\r\n    @property(cc.Node)\r\n    theArm3:cc.Node = null;\r\n\r\n\r\n    //交互节点\r\n    @property(cc.Node)\r\n    touchNode:cc.Node = null;\r\n\r\n\r\n    //火特效节点\r\n    @property(cc.Node)\r\n    fireEffectNode:cc.Node = null;\r\n\r\n    //是否正在触摸\r\n    private _isTouching:boolean = false;\r\n\r\n\r\n    //煎饼\r\n    private _pancake:cc.Node;\r\n\r\n\r\n    onLoad(){\r\n\r\n    }\r\n\r\n    start(){\r\n        //设置可操作\r\n        this.enableTouch = true;\r\n\r\n        //生效皮肤\r\n        this.applySkinData();\r\n\r\n        //创建新的煎饼\r\n        this.createNewPancake();\r\n\r\n        //输出皮肤信息\r\n        //TODO:DEBUG\r\n        // if (GameManager.isDebug) {\r\n            let arms:Array<cc.Node> = [this.theArm1, this.theArm2, this.theArm3];\r\n            let skinData:Array<object> = [];\r\n            arms.forEach(function(arm:cc.Node):void {\r\n                let content:cc.Node = arm.getChildByName(\"content\");\r\n                skinData.push({\"x\":content.x, \"y\":content.y, \"w\":content.width, \"h\":content.height, \"sx\":content.scaleX, \"sy\":content.scaleY, \"r\":content.rotation});\r\n            });\r\n            cc.info(\"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\");\r\n            cc.info(JSON.stringify(skinData));\r\n        // }\r\n\r\n        //监听游戏结束事件\r\n        this.node.on(GameEventNames.GAME_OVER, this.gameOverHandler, this);\r\n    }\r\n\r\n\r\n    private _levelData:LevelData;\r\n\r\n    // 请查看GameConfig中的等级数据配置\r\n    public get levelData():LevelData {\r\n        return this._levelData;\r\n    }\r\n\r\n\r\n    /**\r\n     * 设置等级数据\r\n     */\r\n    public set levelData(v:LevelData) {\r\n        if (!v) return;\r\n        if (this._levelData && this._levelData.level == v.level) return;\r\n\r\n        this._levelData = v;\r\n\r\n        this.refreshPanSkin();\r\n\r\n        //更新物理参数\r\n        if (this._pancake) {\r\n            this._pancake.getComponent(PancakeMain).levelData = this._levelData;\r\n        }\r\n    }\r\n\r\n\r\n\r\n    //当前皮肤\r\n    private _currentSkinName:string = \"2\";\r\n    \r\n    \r\n    /**\r\n     * 设置当前皮肤名\r\n     */\r\n    public set currentSkinName(v:string) {\r\n        if (this._currentSkinName == v) return;\r\n        this._currentSkinName = v;\r\n\r\n        this.applySkinData();\r\n    }\r\n\r\n\r\n    public get currentSkinName():string {\r\n        return this._currentSkinName;\r\n    }\r\n\r\n\r\n    //当前煎饼皮肤\r\n    private _currentPancakeSkinName:string = \"default\";\r\n    \r\n    \r\n    /**\r\n     * 设置当前煎饼皮肤名\r\n     */\r\n    public set currentPancakeSkinName(v:string) {\r\n        if (this._currentPancakeSkinName == v) return;\r\n        this._currentPancakeSkinName = v;\r\n    }\r\n\r\n\r\n    public get currentPancakeSkinName():string {\r\n        return this._currentPancakeSkinName;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 生效皮肤数据\r\n     * \r\n     */\r\n    private applySkinData():void {\r\n        return;//TODO:DEBUG\r\n        if (!this._isOnLoadCalled) return;\r\n\r\n        // name:\"defult\",\r\n        // bigArm:'resources/action/defult/bigArm.png',\r\n        // lowerArm:'resources/action/defult/lowerArm.png',\r\n        // hand:'resources/action/defult/hand.png',\r\n        // pancake:'resources/action/defult/pancake.png',\r\n        // data:[{\"x\":1.3,\"y\":-3,\"w\":152,\"h\":324,\"sx\":1,\"sy\":1},{\"x\":0,\"y\":0,\"w\":143,\"h\":206,\"sx\":1,\"sy\":1},{\"x\":109.9,\"y\":0,\"w\":463,\"h\":66,\"sx\":1,\"sy\":1}],\r\n\r\n        //当前皮肤数据\r\n        let targetSkinData:object;\r\n\r\n        let gameData:GameData = new GameData();\r\n        let skins:Array<object> = gameData.pot;\r\n        for (let i:number = 0; i < skins.length; i++) {\r\n            let skinData:object = skins[i];\r\n            cc.info(skinData[\"name\"], this._currentSkinName);\r\n            if (skinData[\"name\"] == this._currentSkinName) {\r\n                targetSkinData = skinData;\r\n                break;\r\n            }\r\n        }\r\n\r\n        cc.info(\"------------ 皮肤数据 ---------------\");\r\n        cc.info(JSON.stringify(targetSkinData));\r\n        cc.info(\"-----------------------------------\");\r\n        if (!targetSkinData) return;\r\n\r\n        let script:ActionMain = this;\r\n\r\n        let arm1Content:cc.Node = this.theArm1.getChildByName(\"content\");\r\n        arm1Content.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame( cc.textureCache.addImage( cc.url.raw(targetSkinData[\"bigArm\"]), null, null) );\r\n\r\n        let arm2Content:cc.Node = this.theArm2.getChildByName(\"content\");\r\n        arm2Content.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame( cc.textureCache.addImage( cc.url.raw(targetSkinData[\"lowerArm\"]), null, null) );\r\n\r\n        let arm3Content:cc.Node = this.theArm3.getChildByName(\"content\");\r\n        // this._lastPanSkinURL = targetSkinData[\"hand\"];\r\n        // arm3Content.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame( cc.textureCache.addImage( cc.url.raw(this._lastPanSkinURL), null, null) );\r\n\r\n\r\n        //位置、大小、缩放、旋转\r\n        let arms:Array<cc.Node> = [arm1Content, arm2Content, arm3Content];\r\n        let vdata:Array<object> = targetSkinData[\"vdata\"];\r\n        if (vdata && vdata.length == arms.length) {\r\n            for (let i:number = 0; i < arms.length; i++) {\r\n                let armContent:cc.Node = arms[i];\r\n                let theData:object = vdata[i];\r\n    \r\n                // armContent.x = theData[\"x\"];\r\n                // armContent.y = theData[\"y\"];\r\n                // armContent.width = theData[\"w\"];\r\n                // armContent.height = theData[\"h\"];\r\n                // armContent.scaleX = theData[\"sx\"];\r\n                // armContent.scaleY = theData[\"sy\"];\r\n                // armContent.rotation = theData[\"r\"];\r\n            }\r\n        } else {\r\n            cc.info(\"-----------------------------------\");\r\n            cc.info(\"皮肤 \" + this._currentSkinName + \" vdata 数据不正确\");\r\n            cc.info(\"-----------------------------------\");\r\n        }\r\n\r\n        this.refreshPanSkin();\r\n    }\r\n\r\n\r\n\r\n    private _lastPanSkinURL:string;\r\n\r\n    /**\r\n     * 更新锅底的皮肤\r\n     */\r\n    private refreshPanSkin():void {\r\n        return;//TODO:DEBUG\r\n        cc.info(\"【refreshPanSkin】\", this._levelData, this._currentSkinName)\r\n        if (!this._levelData || !this._currentSkinName) return;\r\n\r\n        //当前皮肤数据\r\n        let targetSkinData:object;\r\n\r\n        let gameData:GameData = new GameData();\r\n        let skins:Array<object> = gameData.pot;\r\n        for (let i:number = 0; i < skins.length; i++) {\r\n            let skinData:object = skins[i];\r\n            cc.info(skinData[\"name\"], this._currentSkinName);\r\n            if (skinData[\"name\"] == this._currentSkinName) {\r\n                targetSkinData = skinData;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!targetSkinData) return;\r\n\r\n        let panSkinURL:string = targetSkinData[\"hand\"];\r\n\r\n        //\"panSize\":{number, null},               //0:大, 1:中, 2:小，默认为大\r\n        let panSize:number = this._levelData.panSize;\r\n        let panW:number = 0;\r\n        if (panSize == 1) {\r\n            panSkinURL = panSkinURL.replace(\"_b.png\", \"_m.png\");\r\n            panW = 330;\r\n        } else if (panSize == 2) {\r\n            panSkinURL = panSkinURL.replace(\"_b.png\", \"_s.png\");\r\n            panW = 265;\r\n        } else {\r\n            panW = 395;\r\n        }\r\n\r\n        let collider:cc.PhysicsBoxCollider = this.panBottomNode.getComponent(cc.PhysicsBoxCollider);\r\n        collider.size.width = panW;\r\n        collider.apply();\r\n\r\n        let joint:cc.WeldJoint = this.panBottomNode.getComponent(cc.WeldJoint);\r\n        joint.anchor.x = -panW/2;\r\n        joint.apply();\r\n\r\n        if (panSkinURL != this._lastPanSkinURL) {\r\n            this._lastPanSkinURL = panSkinURL;\r\n\r\n            let arm3Content:cc.Node = this.theArm3.getChildByName(\"content\");\r\n            let sf:cc.SpriteFrame = new cc.SpriteFrame( cc.textureCache.addImage( cc.url.raw(this._lastPanSkinURL), null, null) );\r\n            arm3Content.getComponent(cc.Sprite).spriteFrame = sf;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 创建新的蛋糕\r\n     * \r\n     */\r\n    public createNewPancake():void {\r\n        if (this._pancake) return;\r\n\r\n        //删除所有钻石\r\n        while (this._diamonds.length) {\r\n            this._diamonds.pop().removeFromParent();\r\n        }\r\n\r\n        //=====================================================================\r\n        //当前皮肤数据\r\n        //=====================================================================\r\n        let targetPancakeSkinData:object;\r\n        let gameData:GameData = new GameData();\r\n        let skins:Array<object> = gameData.cake;\r\n        for (let i:number = 0; i < skins.length; i++) {\r\n            let skinData:object = skins[i];\r\n            if (skinData[\"name\"] == this._currentPancakeSkinName) {\r\n                targetPancakeSkinData = skinData;\r\n                break;\r\n            }\r\n        }\r\n\r\n        let texture:cc.Texture2D;\r\n        if (targetPancakeSkinData) {\r\n            texture = cc.textureCache.addImage( cc.url.raw(targetPancakeSkinData[\"pancake\"]), null, null);\r\n        }\r\n        //=====================================================================\r\n         \r\n\r\n        this._pancake = cc.instantiate(this.pancakePrefab);\r\n        this._pancake.getComponent(PancakeMain).levelData = this._levelData;\r\n\r\n        //皮肤\r\n        if (texture) this._pancake.getComponent(PancakeMain).pancakeTexture = texture;\r\n\r\n        this._pancake.x = this.panBottomNode.x;\r\n        this._pancake.y = this.panBottomNode.y + this.cakeInitDistance;\r\n        this.node.addChild(this._pancake);\r\n\r\n        //监听事件\r\n        this._pancake.on(PancakeMain.EVENT_TOUCH_PAN, this.pancakeEventsHandler, this);\r\n        this._pancake.on(PancakeMain.EVENT_ON_PAN, this.pancakeEventsHandler, this);\r\n        this._pancake.on(PancakeMain.EVENT_LEAVE_PAN, this.pancakeEventsHandler, this);\r\n        this._pancake.on(PancakeMain.EVENT_GET_DIAMOND, this.pancakeEventsHandler, this);\r\n        this._pancake.on(PancakeMain.EVENT_GET_SCORE, this.pancakeEventsHandler, this);\r\n        this._pancake.on(PancakeMain.EVENT_DIE, this.pancakeEventsHandler, this);\r\n\r\n        //恢复参数\r\n        this._isOver = false;\r\n    }\r\n\r\n    //宝石\r\n    private _diamonds:Array<cc.Node> = [];\r\n\r\n    /**\r\n     * 创建一个新的钻石\r\n     */\r\n    private createNewDiamond():void {\r\n        cc.info(\"【createNewDiamond】\");\r\n        if (this._diamonds.length > 0) return;\r\n\r\n        //================================================================\r\n        //钻石数量\r\n        //================================================================\r\n        let diamCount:number = 0;\r\n\r\n        //请查看GameConfig中的等级数据配置\r\n        let values:Array<number> = this.levelData.diamondValues;\r\n        if (values && values.length > 0) {\r\n            let randomV:number = Math.random();\r\n            let v:number = 0;\r\n            for (let i:number = 0; i < values.length; i++) {\r\n                v += values[i];\r\n                if (v >= randomV) {\r\n                    diamCount = i;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        //================================================================\r\n\r\n        if (diamCount > 0) {\r\n            let diam:cc.Node = cc.instantiate(this.diamondPrefab);\r\n            diam.x = this.diamondContainer.width / 2 - Math.random() * this.diamondContainer.width;\r\n            diam.y = this.diamondContainer.height / 2 - Math.random() * this.diamondContainer.height;\r\n            diam.getComponent(DiamondMain).count = diamCount;\r\n\r\n            this.diamondContainer.addChild(diam);\r\n            this._diamonds.push(diam);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 移除宝石\r\n     */\r\n    private removeADiamond(diam:cc.Node):void {\r\n        let index:number = this._diamonds.indexOf(diam);\r\n        if (index >= 0) {\r\n            this._diamonds.splice(index, 1);\r\n            \r\n            // diam.removeFromParent(true);\r\n            diam.getComponent(DiamondMain).doDisappear();\r\n        }\r\n    }\r\n\r\n\r\n    //是否是第一次tap\r\n    private _doneFirstTap:boolean;\r\n\r\n    //开始触摸\r\n    private touchStartHandler(e:cc.Event):void {\r\n        cc.info(\"【touchStartHandler】\");\r\n        this._isTouching = true;\r\n\r\n        if (this._pancake) {\r\n            this.activeCake();\r\n    \r\n            if (!this._doneFirstTap) {\r\n                this._doneFirstTap = true;\r\n                this.node.dispatchEvent(new cc.Event(GameSceneEvents.GAME_START, true));\r\n            } else {\r\n                //音效\r\n                GameManager.soundsManager.playSound(\"resources/sounds/throw.mp3\");\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    // 触摸结束\r\n    private touchEndHandler(e:cc.Event):void {\r\n        this._isTouching = false;\r\n    }\r\n\r\n    /**\r\n     * 获取饼是否已激活\r\n     */\r\n    public get cakeActived():boolean {\r\n        return this._pancake.getComponent(PancakeMain).actived;\r\n    }\r\n    \r\n\r\n    /**\r\n     * 激活饼\r\n     * \r\n     */\r\n    public activeCake():void {\r\n        //让煎饼落下。\r\n        this._pancake.getComponent(PancakeMain).active();\r\n    }\r\n\r\n\r\n\r\n    private _enableTouch:boolean;\r\n\r\n\r\n    /**\r\n     * 设置是否可操作\r\n     */\r\n    public set enableTouch(v:boolean) {\r\n        cc.info(\"【enableTouch】\", v);\r\n\r\n        if (this._enableTouch == v) return;\r\n        this._enableTouch = v;\r\n\r\n        if (this._enableTouch) {\r\n            this.touchNode.on(cc.Node.EventType.TOUCH_START, this.touchStartHandler, this);\r\n            this.touchNode.on(cc.Node.EventType.TOUCH_END, this.touchEndHandler, this);\r\n        } else {\r\n            this._isTouching = false;\r\n\r\n            this.touchNode.off(cc.Node.EventType.TOUCH_START, this.touchStartHandler, this);\r\n            this.touchNode.off(cc.Node.EventType.TOUCH_END, this.touchEndHandler, this);\r\n        }\r\n    }\r\n\r\n\r\n    public get enableTouch():boolean {\r\n        return this._enableTouch;\r\n    }\r\n    \r\n\r\n\r\n    /**\r\n     * 宝石数量\r\n     */\r\n    private _diamondCount:number = 0;\r\n\r\n    public get diamondCount():number {\r\n        return this._diamondCount;\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 分数\r\n     */\r\n    private _score:number = 0;\r\n\r\n    public get score():number {\r\n        return this._score;\r\n    }\r\n\r\n\r\n    private _isOver:boolean;\r\n\r\n    /**\r\n     * 游戏是否结束\r\n     */\r\n    public get isOver():boolean {\r\n        return this._isOver;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param e\r\n     */\r\n    private pancakeEventsHandler(e:cc.Event):void {\r\n        // cc.info(\"【ActionMain pancakeEventsHandler】\", e.type);\r\n\r\n        let eType:string = e.type;\r\n        switch (eType) {\r\n            case PancakeMain.EVENT_TOUCH_PAN:\r\n                //接触锅底\r\n                let pancakeMain:PancakeMain = this._pancake.getComponent(PancakeMain);\r\n                if (pancakeMain.state == PancakeStates.FALLING) {\r\n                    //如果是下落过程，播放油喷溅效果\r\n                    let point:cc.Vec2 = e[\"data\"];\r\n                    // cc.info(point.x, point.y);\r\n                    // let newPo:cc.Vec2 = this.node.convertToNodeSpace(point);\r\n                    // cc.info(newPo.x, newPo.y, \"@@@@@@@@\");\r\n                    this.newOilEffect(point);\r\n                }\r\n                break;\r\n            case PancakeMain.EVENT_ON_PAN:\r\n                this.createNewDiamond();\r\n\r\n                this.pancakeOnPan();\r\n                break;\r\n            case PancakeMain.EVENT_LEAVE_PAN:\r\n                this.cancelPancakeOnPan();\r\n                break;\r\n            case PancakeMain.EVENT_GET_SCORE:\r\n                let score:number = parseInt(e[\"data\"]);\r\n                if (!isNaN(score) && score > 0) {\r\n                    cc.info(\"获得分数\", score);\r\n\r\n                    this._score += score;\r\n\r\n                    //音效\r\n                    this.schedule(function():void {\r\n                        GameManager.soundsManager.playSound(\"resources/sounds/getscore.mp3\");\r\n                    }, 0.1, score);\r\n\r\n                    //抛出事件\r\n                    this.node.dispatchEvent(new cc.Event(GameSceneEvents.SCORE_CHANGED, false));\r\n                }\r\n                break;\r\n            case PancakeMain.EVENT_GET_DIAMOND:\r\n                let theDiamond:cc.Node = e[\"data\"] as cc.Node;\r\n\r\n                //播放音效\r\n                GameManager.soundsManager.playSound(\"resources/sounds/getdiam.mp3\");\r\n\r\n                //每个宝石节点会携带不同数量的宝石数量\r\n                this._diamondCount += theDiamond.getComponent(DiamondMain).count;\r\n\r\n                //移除宝石\r\n                this.removeADiamond(theDiamond);\r\n\r\n                //抛出事件\r\n                this.node.dispatchEvent(new cc.Event(GameSceneEvents.DIAMONDS_CHANGED, false));\r\n                break;\r\n            case PancakeMain.EVENT_DIE:\r\n                //抛出事件\r\n                if (!this._isOver) {\r\n                    this.node.dispatchEvent(new cc.Event(GameSceneEvents.GAME_OVER, false));\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n\r\n    private _oilEffects:Array<cc.Node> = [];\r\n\r\n    /**\r\n     * 创建一个油溅效果\r\n     */\r\n    private newOilEffect(po:cc.Vec2):void {\r\n        //检查摩擦系数\r\n        if (this._levelData.friction >= GameConfig.PANCAKE_FRICTION) return;\r\n\r\n        let effect:cc.Node;\r\n        if (this._oilEffects.length < 10) {\r\n            effect = cc.instantiate(this.oilEffectPrefab);\r\n            cc.director.getScene().addChild(effect)\r\n        } else {\r\n            effect = this._oilEffects.shift();\r\n            effect.getComponent(cc.ParticleSystem).resetSystem();\r\n        }\r\n        \r\n        this._oilEffects.push(effect);\r\n\r\n        effect.x = po.x;\r\n        effect.y = po.y;\r\n        // this.node.addChild(effect);\r\n    }\r\n\r\n    \r\n    /**\r\n     * 煎饼在锅底上是，开始处理限时逻辑\r\n     * \r\n     */\r\n    private pancakeOnPan():void {\r\n        //[停留多少秒开始着火, 每多秒扣一分]\r\n        //扣分至当前等级最低分时，停止扣分\r\n        cc.info(\"【pancakeOnPan】\", this._levelData.timeLimitedValue);\r\n        if (!this._levelData.timeLimitedValue) return;\r\n\r\n        this.fireEffectNode.active = false;\r\n        this._onPanTime = 0;\r\n        this._lastMinusScoreTime = NaN;\r\n\r\n        this.unschedule(this.onPaning);\r\n        this.schedule(this.onPaning, 1, 1000);\r\n    }\r\n\r\n    //在锅底上的时间（秒）\r\n    private _onPanTime:number;\r\n    private _lastMinusScoreTime:number;\r\n    private onPaning():void {\r\n        if (!this._levelData.timeLimitedValue) return;\r\n\r\n        this._onPanTime++;\r\n\r\n        //[停留多少秒开始着火, 每多秒扣一分, 多少秒后直接死亡]\r\n        if (this._onPanTime >= this._levelData.timeLimitedValue[0]) {\r\n            this.fireEffectNode.active = true;\r\n\r\n            //播放音效\r\n            GameManager.soundsManager.playSound(\"resources/sounds/firing.mp3\", true);\r\n\r\n            if (isNaN(this._lastMinusScoreTime)) this._lastMinusScoreTime = this._levelData.timeLimitedValue[0];\r\n\r\n            let deltaT:number = this._onPanTime - this._lastMinusScoreTime;\r\n            deltaT = Math.floor(deltaT / this._levelData.timeLimitedValue[1]);\r\n            if (deltaT > 0) {\r\n                //检查最低分\r\n                if (this._score > this._levelData.minScore) {\r\n                    //减去分数\r\n                    this._score -= 1;\r\n\r\n                    //抛出事件\r\n                    this.node.dispatchEvent(new cc.Event(GameSceneEvents.SCORE_CHANGED, false));\r\n                    this._lastMinusScoreTime = this._onPanTime;\r\n                } else {\r\n                    this.cancelPancakeOnPan();\r\n                }\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 煎饼离开锅底\r\n     */\r\n    private cancelPancakeOnPan():void {\r\n        if (!this._levelData.timeLimitedValue) return;\r\n\r\n        //停止播放音效\r\n        GameManager.soundsManager.stopSound(\"resources/sounds/firing.mp3\");\r\n\r\n\r\n        this.fireEffectNode.active = false;\r\n        this.unschedule(this.onPaning);\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 游戏结束事件\r\n     * \r\n     * @param e \r\n     */\r\n    private gameOverHandler(e:cc.Event):void {\r\n        if (this._isOver) return;\r\n        this._isOver = true;\r\n\r\n        //停止播放音效\r\n        let audio:cc.AudioSource = this.fireEffectNode.getComponent(cc.AudioSource);\r\n        if (audio.isPlaying) audio.stop();\r\n\r\n        this.cancelPancakeOnPan();\r\n\r\n        if (this._pancake) {\r\n            this._pancake.removeFromParent(true);\r\n            this._pancake = null;\r\n        }\r\n    }\r\n\r\n\r\n    update (dt) {\r\n        //如果有触发\r\n        if (this._isTouching) {\r\n            let body:cc.RigidBody = this.theArm1.getComponent(cc.RigidBody);\r\n            body.applyLinearImpulse(new cc.Vec2(this._levelData.forceValue, 0), new cc.Vec2(0, 0), true);\r\n            // body.applyForceToCenter(new cc.Vec2(this.forceValue, 0), true);\r\n            // body.applyForce(new cc.Vec2(this.forceValue, 0), new cc.Vec2(0, 0), true);\r\n        }\r\n\r\n\r\n        // let frames:number = cc.director.getTotalFrames();\r\n        // if (frames % 20 == 0) {\r\n        // }\r\n\r\n\r\n    }\r\n\r\n\r\n    onDestroy() {\r\n    }\r\n}\r\n"]}