{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\Task/assets\\Script\\Task\\TaskItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\Task","sourcesContent":["\r\nimport GameManager from \"../gamecore/managers/GameManager\";\r\nimport GameEventNames from \"../GameEventNames\";\r\nimport StateManage from \"../StateManage/StateManage\";\r\nimport TaskMode from \"./TaskMode\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class TaskItem extends cc.Component {\r\n\r\n    // public data:object=null;\r\n\r\n    @property(cc.Label)\r\n    taskName:cc.Label = null;\r\n    @property(cc.Label)\r\n    taskDetails:cc.Label = null;\r\n    @property(cc.Label)\r\n    plan:cc.Label = null;\r\n    @property(cc.Node)\r\n    progress:cc.Node = null;\r\n    // 未领取\r\n    @property(cc.Node)\r\n    rewardedBtnY:cc.Node = null;\r\n    // 能领取\r\n    @property(cc.Node)\r\n    rewardedBtnN:cc.Node = null;\r\n    // 进行中\r\n    @property(cc.Node)\r\n    playbar:cc.Node = null;\r\n    // 刷新按钮\r\n    @property(cc.Node)\r\n    refreshBtn:cc.Node = null;\r\n\r\n    private _itemData: object;\r\n    get data(): object {\r\n        return this._itemData;\r\n    }\r\n    set data(v: object) {\r\n        if (this._itemData != v) {\r\n            this._itemData = v;\r\n            this.refreshUI();\r\n        }\r\n    }\r\n    // onLoad () {}\r\n    // start () {}\r\n    // 更新UI\r\n    private refreshUI():void{\r\n        let data = this.data;\r\n        this.taskName.string = data[\"taskContent\"][\"title\"];\r\n        this.taskDetails.string = \"任务奖励：宝石×\"+data[\"taskContent\"][\"awardNum\"];\r\n\r\n        cc.log(\"isFinish\",this.data[\"isFinish\"])\r\n\r\n        if(this.data[\"isFinish\"]){\r\n            this.playbar.active = false;\r\n            if(this.data[\"isgaina\"]){\r\n                cc.log(\"不能领取\")\r\n\r\n                this.rewardedBtnN.active = true;\r\n                this.rewardedBtnY.active = false;\r\n\r\n                if(this.data[\"tasknum\"] >0){\r\n                    this.refreshBtn.active = true;\r\n                }else{\r\n                    this.refreshBtn.active = false;\r\n                }\r\n            }else{\r\n                cc.log(\"能领取\")\r\n                this.refreshBtn.active = false;\r\n\r\n                this.rewardedBtnY.active = true;\r\n                this.rewardedBtnN.active = false;\r\n                \r\n            }\r\n        }else{\r\n            this.playbar.active = true;\r\n            this.rewardedBtnN.active = false;\r\n            this.rewardedBtnY.active = false;\r\n            if(this.data[\"tasknum\"]>0){\r\n                this.refreshBtn.active = true;\r\n            }else{\r\n                this.refreshBtn.active = false;\r\n            }\r\n        }\r\n        let selfPlan:number = StateManage.instance.getData(data[\"taskContent\"][\"value\"]);\r\n        let goal = data[\"taskContent\"][\"goal\"];\r\n        selfPlan = selfPlan > goal ? goal : selfPlan;\r\n        this.plan.string = selfPlan + \"/\" + goal;\r\n        this.progress.width = (116/goal) * selfPlan;\r\n    }\r\n    /**\r\n     * 完成任务获取指定奖励\r\n     * 任务状态 1 完成了    2 未完成    finish\r\n     * 完成了   1 已领取    2 未领取    gain\r\n     */\r\n    public affirmBtn(event:cc.Event):void{\r\n        GameManager.soundsManager.playTapSound();\r\n        TaskMode.instance.receiveAward(this.data);\r\n        this.refreshUI();\r\n    }\r\n    // 开始游戏或者分享\r\n    public playbarBtn(event:cc.Event):void{\r\n        GameManager.soundsManager.playTapSound();\r\n        cc.log(\"开始游戏或者分享\");\r\n    }\r\n    // 刷新任务\r\n    public refresh(){\r\n        let title:string = \"\";\r\n        let script:TaskItem = this;\r\n        let callback:Function = function(){};\r\n        title = \"要观看一次广告来替换这个任务吗？\";\r\n        callback = function(label:string):void {\r\n            cc.info(label)\r\n            if (label == \"ok\") {\r\n                script.affirm();\r\n            }\r\n            if(label == \"off\"){}\r\n            GameManager.soundsManager.playTapSound();\r\n        }\r\n        GameManager.eventManager.dispatchEventWith(GameEventNames.SHOW_ALERT, [title, callback]);\r\n        GameManager.soundsManager.playTapSound();\r\n    }\r\n    // 确认更新\r\n    public affirm(){\r\n        TaskMode.instance.refreshTask(this.data);\r\n    }\r\n    // update (dt) {}\r\n\r\n}\r\n"]}