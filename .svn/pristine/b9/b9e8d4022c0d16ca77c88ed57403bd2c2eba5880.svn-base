{"version":3,"sources":["AdButton.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/Script/gamecore/xiaoyaoji","sourcesContent":["import { TweenLite, Ease } from \"../libs/TweenLite\";\nimport { Bounce, Elastic } from \"../libs/EasePack\";\nimport GameManager from \"../managers/GameManager\";\nimport XYJAPI from \"./XYJAPI\";\nimport WXCore from \"../wechat/WXCore\";\n\n// Learn TypeScript:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\nconst {ccclass, property} = cc._decorator;\n\n/**\n * 广告按钮\n */\n\n@ccclass\nexport default class AdButton extends cc.Component {\n\n    @property(cc.Node)\n    button:cc.Node = null;\n\n    /**\n     * 动画间隔\n     */\n    effectDelay:number = 3;\n\n\n    //交叉推广图url\n    private _adImageURL:string = null;\n\n    start () {\n        this.button.on(cc.Node.EventType.TOUCH_END, this.adBtnClickHandler, this);\n\n        this.showEffect();\n\n        //默认不可见\n        this.node.active = false;\n        \n        //请求数据\n        let script:AdButton = this;\n        XYJAPI.getAdImage(function(data:object):void {\n            if (data && data[\"imageurl\"]) {\n                script._adImageURL = data[\"imageurl\"];\n                script.node.active = true;\n            }\n        });\n    }\n\n\n    // update (dt) {}\n\n    /**\n     * 广告按钮点击\n     * @param e \n     */\n    private adBtnClickHandler(e:cc.Event.EventTouch):void {\n        GameManager.soundsManager.playTapSound();\n\n        //预览图片\n        WXCore.previewImage([this._adImageURL]);\n    }\n\n    /**\n     * 播放效果\n     */\n    private showEffect():void {\n        if (this.zoomTween) this.zoomTween.kill();\n        if (this.shakeTween) this.zoomTween.kill();\n        \n        if (Math.random() > 0.5) {\n            this.effectZoom();\n        } else {\n            this.effectShake();\n        }\n\n        this.schedule(this.showEffect, this.effectDelay + Math.random(), 1);\n    }\n\n\n    private shakeTween:any;\n\n    /**\n     * 晃动\n     */\n    private effectShake():void {\n        let toR:number = (40 + Math.random() * 10) * (Math.random() > 0.5 ? 1 : -1);\n        TweenLite.to(this.button, 0.5, {\"rotation\":toR});\n        TweenLite.to(this.button, 0.8, {\n            \"delay\":0.5,\n            \"rotation\":0,\n            \"ease\":Elastic.easeOut\n        });\n    }\n\n\n    private zoomTween:any;\n\n    /**\n     * 缩放\n     */\n    private effectZoom():void {\n        if (this.zoomTween) this.zoomTween.kill();\n        if (this.shakeTween) this.zoomTween.kill();\n\n        let toS:number = 0.6 + Math.random() * 0.2;\n        TweenLite.to(this.button, 0.5, {\"scale\":toS});\n        TweenLite.to(this.button, 0.8, {\n            \"delay\":0.5,\n            \"scale\":1,\n            \"ease\":Elastic.easeOut\n        });\n    }\n\n\n    onDestroy() {\n        if (this.zoomTween) this.zoomTween.kill();\n        if (this.shakeTween) this.zoomTween.kill();\n\n        this.unschedule(this.showEffect);\n    }\n}\n"]}