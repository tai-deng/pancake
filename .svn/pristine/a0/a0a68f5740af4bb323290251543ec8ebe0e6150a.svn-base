import GameManager from "../gamecore/managers/GameManager";
import WXCore from "../gamecore/wechat/WXCore";
import Utils from "../gamecore/managers/Utils";
const {ccclass, property} = cc._decorator;

@ccclass
export default class RankSmall extends cc.Component {

    @property(cc.Node)
    moreBtn: cc.Node = null;
    @property(cc.Node)
    anewStart:cc.Node = null;
    @property(cc.Node)
    share:cc.Node = null;
    
    // onLoad () {}

    start () {
        if(!this._isOnLoadCalled) return;
        this.moreBtn.on(cc.Node.EventType.TOUCH_END,this.onMoreBtn,this);
        this.anewStart.on(cc.Node.EventType.TOUCH_END,this.onAnewStart,this);
        this.share.on(cc.Node.EventType.TOUCH_END,this.onShare,this);
        this.refreshUI();
        
        Utils.scaleContentAuto(cc.find("container",this.node));
        Utils.scaleContentAuto(cc.find("title",this.node));
        Utils.scaleContentAuto(cc.find("again",this.node));
        Utils.scaleContentAuto(cc.find("subContent",this.node));
        console.log(cc.find("container",this.node).name,cc.find("title",this.node).name,cc.find("again",this.node).name,cc.find("subContent",this.node).name)
    }
    private onMoreBtn(){
        this.moreBtn.active = false;
        this.share.active = true;
        this.anewStart.active = false;
        GameManager.soundsManager.playTapSound();
        console.log("更多排行榜")
    }
    private onAnewStart(){
        this.anewStart.active = false;
        GameManager.soundsManager.playTapSound();
        cc.director.loadScene("gameScene");
        console.log("再来一次")
    }
    private onShare(){
        console.log("分享")
        GameManager.soundsManager.playTapSound();
        
        WXCore.shareApp("煎饼",cc.url.raw("resources/share/shareBG.png"));
    }
    private refreshUI(){
        this.moreBtn.active = true;
        this.anewStart.active = true;
        this.share.active = true;
        if(typeof wx == "undefined") return;
        let openData = wx.getOpenDataContext()
        openData.postMessage({
            "direction":1,
        })
    }
    // update (dt) {}
}
