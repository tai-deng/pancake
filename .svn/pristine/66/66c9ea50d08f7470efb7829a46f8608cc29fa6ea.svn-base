{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\gamecore\\managers/assets\\Script\\gamecore\\managers\\UtilsManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\gamecore\\managers","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\nimport {TweenLite} from \"../libs/TweenLite\";\r\n\r\n/**\r\n * 游戏功能管理。比如震动关闭、开启\r\n */\r\n@ccclass\r\nexport default class UtilsManager extends cc.EventTarget {\r\n\r\n    \r\n    /**\r\n     *\r\n     */\r\n    constructor() {\r\n        super();\r\n    }\r\n\r\n\r\n    //============================================================================\r\n\r\n    //iphone x 顶部条高度\r\n    get iphoneXTopBarHeight():number {\r\n        return 44;\r\n    }\r\n\r\n    /**\r\n     * 检查是否是iphoneX\r\n     * \r\n     */\r\n    get isIphoneX():boolean {\r\n        try {\r\n            return /iphone/gi.test(navigator.userAgent) && (screen.height == 812 && screen.width == 375);\r\n        } catch (error) {\r\n            \r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n\r\n\r\n    // private _lockSenceNode:cc.Node;\r\n\r\n    // /**\r\n    //  * 锁定场景\r\n    //  */\r\n    // lockSence():void {\r\n        \r\n    // }\r\n\r\n    // /**\r\n    //  * 解除锁定舞台\r\n    //  */\r\n    // unlockSence():void {\r\n\r\n    // }\r\n\r\n\r\n    /**\r\n     * 将cocos中canvas的rect数据转换为屏幕中的rect数据\r\n     * \r\n     * @param rect \r\n     */\r\n    toScreenRect(rect:cc.Rect):cc.Rect {\r\n        // cc.info(\"!!!!!!!!!!!!!!!!!!!!!!\");\r\n        let winSize:cc.Size = cc.director.getWinSize();\r\n        \r\n        let newRect:cc.Rect = rect.clone();\r\n        // cc.info(newRect.x, newRect.y, newRect.width, newRect.height, newRect.xMin, newRect.yMax);\r\n        //转换为左上角作为(0, 0)点的坐标\r\n        newRect.x = rect.xMin;\r\n        newRect.y = winSize.height - newRect.yMax;\r\n        // cc.info(newRect.x, newRect.y, newRect.width, newRect.height);\r\n        \r\n        //获取屏幕尺寸\r\n        let screenSize:cc.Size = cc.view.getFrameSize();\r\n        // cc.info(\"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\");\r\n        // cc.info(screenSize.width, screenSize.height);\r\n        \r\n        //计算缩放比例\r\n        //TODO:NEXT，需要检查canvas的适配策略\r\n        let s:number = screenSize.height / winSize.height;\r\n        // cc.info(\"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\", s);\r\n        \r\n        \r\n        newRect.x *= s;\r\n        newRect.y *= s;\r\n        newRect.width *= s;\r\n        newRect.height *= s;\r\n        // cc.info(newRect.x, newRect.y, newRect.width, newRect.height);\r\n\r\n        return newRect;\r\n    }\r\n\r\n\r\n    /**\r\n     * 将屏幕中的矩形区域，转换为cocos中canvas的矩形区域\r\n     * \r\n     * @param rect \r\n     */\r\n    fromScreenRect(rect:cc.Rect):cc.Rect {\r\n        // cc.info(\"!!!!!!!!!!!!!!!!!!!!!!\");\r\n        // cc.info(\"fromScreenRect\");\r\n\r\n        let winSize:cc.Size = cc.director.getWinSize();\r\n        \r\n        let newRect:cc.Rect = rect.clone();\r\n        // cc.info(newRect.x, newRect.y, newRect.width, newRect.height);\r\n        \r\n        //获取屏幕尺寸\r\n        let screenSize:cc.Size = cc.view.getFrameSize();\r\n        // cc.info(\"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\");\r\n        // cc.info(screenSize.width, screenSize.height);\r\n        newRect.y = screenSize.height - newRect.y - newRect.height;\r\n        \r\n        //计算缩放比例\r\n        //TODO:NEXT，需要检查canvas的适配策略\r\n        let s:number = screenSize.height / winSize.height;\r\n        newRect.x /= s;\r\n        newRect.y /= s;\r\n        newRect.width /= s;\r\n        newRect.height /= s;\r\n        \r\n        let canvasRect:cc.Rect = new cc.Rect(newRect.x, newRect.y, newRect.width, newRect.height);\r\n        // cc.info(\"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\", s);\r\n        // cc.info(canvasRect.x, canvasRect.y, canvasRect.width, canvasRect.height)\r\n        return canvasRect;\r\n    }\r\n\r\n\r\n    /**\r\n     * 将cocos的资源路径转换为微信小游戏的资源路径。\r\n     * \r\n     * @param resourcePath \r\n     */\r\n    toWechatMiniGameResourcePath(resourcePath:string):string {\r\n        if (resourcePath.charAt(0) == \"/\") resourcePath = resourcePath.substr(1);\r\n        return \"res/raw-assets/\" + resourcePath;\r\n    }\r\n\r\n\r\n    //==============================================================\r\n    private _labelToTweenMap:object = {};\r\n\r\n    /**\r\n     * 将一个label的值增加到或减少到另外一个值。\r\n     * 比如是整数。\r\n     * \r\n     * @param label \r\n     * @param v \r\n     * @param duration          动画时间\r\n     */\r\n    labelStringToValue(label:cc.Label, v:number, duration:number = 0.5):void {\r\n        let uuid:string = label.uuid;\r\n\r\n        let tween:TweenLite = this._labelToTweenMap[uuid] as TweenLite;\r\n        if (tween) tween.kill();\r\n\r\n        let currentV:number = parseInt(label.string);\r\n        if (isNaN(currentV)) currentV = 0;\r\n\r\n        let step:number = (currentV > v) ? -1 : 1;\r\n        \r\n        let obj:object = {\"v\":currentV};\r\n        tween = TweenLite.to(\r\n                obj, \r\n                duration, \r\n                {\r\n                    \"v\":v,\r\n                    \"onUpdate\":function(obj:object):void {\r\n                        let v = Math.floor(obj[\"v\"]);\r\n                        label.string = \"\" + v;\r\n                    },\r\n                    \"onUpdateParams\":[obj]\r\n                }\r\n            );\r\n    }\r\n\r\n\r\n}\r\n"]}