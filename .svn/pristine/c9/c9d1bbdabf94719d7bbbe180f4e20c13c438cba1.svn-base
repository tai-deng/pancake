{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\shopping/assets\\Script\\shopping\\ShopMod.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\shopping","sourcesContent":["import Json from \"../Json/Json\";\r\nimport StateManage from \"../StateManage/StateManage\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class ShopMod extends cc.Node {\r\n\r\n    private static _instance:ShopMod = null;\r\n    public static get instance():ShopMod {\r\n        if (!ShopMod._instance) ShopMod._instance = new ShopMod();\r\n        \r\n        return ShopMod._instance;\r\n    }\r\n\r\n    private _potList:Array<any> = [];\r\n    private _pancakeList:Array<any> = [];\r\n    private _showTab:boolean;    // true 显示 pot false  显示 cake\r\n    \r\n\r\n\r\n    private initData(){\r\n        let goods = new Json().goods;\r\n        for(let i = 0;i < goods.length; ++i){\r\n            let item = this.createShopNode();\r\n            this._potList.push(item);\r\n        }\r\n    }\r\n    private createShopNode(){\r\n        cc.loader.loadRes(\"shopping/item\", function(err, prefab){\r\n            return cc.instantiate(prefab);\r\n        });\r\n    }\r\n    // 获取锅数据\r\n    public getPotList():Array<any> {\r\n        return this._potList.concat();\r\n    }\r\n    // 获取饼数据\r\n    public getCakeList(){\r\n        return this._pancakeList;\r\n    }\r\n    // 购买物品\r\n    public buyShop(){\r\n        if(this._showTab){\r\n            this._potList.forEach(function(ele,ind) {\r\n                // 待解锁改成 已解锁,已购买,取消新品  下个商品改成 待解锁 未购买 新品\r\n                if(ele[\"isUse\"]==2){\r\n                    ele[\"isUse\"]==1;\r\n                    ele[\"isBuy\"]==1;\r\n                    ele[\"newPro\"]==2;\r\n                    this._potList[ind+1][\"isUse\"] = 2;\r\n                    this._potList[ind+1][\"isBuy\"] = 2;\r\n                    this._potList[ind+1][\"newPro\"] = 1;\r\n                    return;\r\n                }\r\n            }.bind(this));\r\n        }else{\r\n            this._pancakeList.forEach(function(ele,ind) {\r\n                if(ele[\"isUse\"]==2){\r\n                    ele[\"isUse\"]==1;\r\n                    ele[\"isBuy\"]==1;\r\n                    ele[\"newPro\"]==2;\r\n                    this._potList[ind+1][\"isUse\"] = 2;\r\n                    this._potList[ind+1][\"isBuy\"] = 2;\r\n                    this._potList[ind+1][\"newPro\"] = 1;\r\n                    return;\r\n                }\r\n            }.bind(this));\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    public useSkin(skil:any):void {\r\n        \r\n\r\n        this.dispatchEvent(new cc.Event(\"currentUseChanged\", false));\r\n    }\r\n\r\n\r\n    public purchaseSkin(skin:any):void {\r\n\r\n\r\n        this.dispatchEvent(new cc.Event(\"purchase\", false));\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n"]}