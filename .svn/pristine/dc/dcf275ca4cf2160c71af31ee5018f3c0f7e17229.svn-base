{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\gamecore\\legs/assets\\Script\\gamecore\\legs\\Command.ts"],"names":[],"mappings":";;;;;AAAA,uDAAkD;AAG5C,IAAA,kBAAmC,EAAlC,oBAAO,EAAE,sBAAQ,CAAkB;AAG1C;;GAEG;AAGH;IADA;QAoBI,cAAc;QACJ,eAAU,GAAU,IAAI,CAAC;IA6EvC,CAAC;gBAjGoB,OAAO;IAyBxB,sBAAW,8BAAS;QAHpB;;WAEG;aACH;YACI,OAAO,IAAI,CAAC,UAAU,CAAC;QAC3B,CAAC;;;OAAA;IAKD,sBAAW,2BAAM;QAHjB;;WAEG;aACH;YACI,IAAI,CAAC,IAAI,CAAC,UAAU;gBAAE,OAAO,IAAI,CAAC;YAClC,OAAO,SAAO,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAc,CAAC;QAC3D,CAAC;;;OAAA;IAED;;;;;OAKG;IACK,4BAAU,GAAjB,UAAkB,QAAwB;QAAxB,yBAAA,EAAA,eAAwB;QACvC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YAClB,IAAI,QAAQ,IAAI,IAAI;gBAAE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC1C,OAAO;SACV;QAED,IAAI,SAAO,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE;YACpC,IAAI,QAAQ,IAAI,IAAI;gBAAE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC1C,OAAO;SACV;QAED,IAAI,OAAO,GAAW,IAAI,CAAC;QAE3B,EAAE,CAAC,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC;QACpD,YAAY;QACZ,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,UAAU,GAAG,EAAE,MAAM;YACpD,EAAE,CAAC,IAAI,CAAC,yBAAyB,EAAE,GAAG,EAAE,MAAM,CAAC,CAAC;YAEhD,IAAI,MAAM,EAAE;gBACR,SAAO,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,MAAM,CAAC;aAClD;iBAAM;gBACH,EAAE,CAAC,IAAI,CAAC,6BAA6B,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;aAC/D;YAED,IAAI,QAAQ,IAAI,IAAI;gBAAE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;IACP,CAAC;IAGD;;OAEG;IACI,yBAAO,GAAd;IAEA,CAAC;IAED;;;;OAIG;IACI,+BAAa,GAApB,UAAqB,KAAc;QAC/B,qBAAW,CAAC,YAAY,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;IAClD,CAAC;IAED;;;;;OAKG;IACI,mCAAiB,GAAxB,UAAyB,SAAgB,EAAE,IAAe;QAAf,qBAAA,EAAA,WAAe;QACtD,qBAAW,CAAC,YAAY,CAAC,iBAAiB,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IAChE,CAAC;IA9FD;;OAEG;IACY,iBAAS,GAAU,EAAE,CAAC;IALpB,OAAO;QAD3B,OAAO;OACa,OAAO,CAiG3B;IAAD,cAAC;;CAjGD,AAiGC,IAAA;kBAjGoB,OAAO","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\gamecore\\legs","sourcesContent":["import GameManager from \"../managers/GameManager\";\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n\r\n/**\r\n * command\r\n */\r\n\r\n@ccclass\r\nexport default class Command {\r\n\r\n    /**\r\n     * prefab url to cc.Prefab\r\n     */\r\n    private static prefabMap:object = {};\r\n\r\n\r\n    /**\r\n     * 事件\r\n     */\r\n    event:cc.Event;\r\n\r\n    /**\r\n     * 事件携带数据\r\n     */\r\n    data:any;\r\n\r\n\r\n    //prefab资源加载路径\r\n    protected _prefabURL:string = null;\r\n\r\n    /**\r\n     * 获取资源加载路径\r\n     */\r\n    public get prefabURL():string {\r\n        return this._prefabURL;\r\n    }\r\n\r\n    /**\r\n     * 获取资源是否已加载完成\r\n     */\r\n    public get prefab():cc.Prefab {\r\n        if (!this._prefabURL) return null;\r\n        return Command.prefabMap[this._prefabURL] as cc.Prefab;\r\n    }\r\n\r\n    /**\r\n     * 加载素材\r\n     * \r\n     * @param callback  回调方法\r\n     * \r\n     */\r\n     public loadPrefab(callback:Function = null):void {\r\n        if (!this._prefabURL) {\r\n            if (callback != null) callback.call(null);\r\n            return;\r\n        }\r\n\r\n        if (Command.prefabMap[this._prefabURL]) {\r\n            if (callback != null) callback.call(null);\r\n            return;\r\n        }\r\n\r\n        let command:Command = this;\r\n\r\n        cc.info(\"[Command] load prefab \" + this._prefabURL);\r\n        // 加载 Prefab\r\n        cc.loader.loadRes(this._prefabURL, function (err, prefab) {\r\n            cc.info(\"[Command] prefab loaded\", err, prefab);\r\n            \r\n            if (prefab) {\r\n                Command.prefabMap[command._prefabURL] = prefab;\r\n            } else {\r\n                cc.info(\"[Command] prefab load fail:\" + command._prefabURL);\r\n            }\r\n            \r\n            if (callback != null) callback.call(null);  \r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * 执行命令\r\n     */\r\n    public execute():void {\r\n\r\n    }\r\n\r\n    /**\r\n     * 派发事件\r\n     * \r\n     * @param event \r\n     */\r\n    public dispacheEvent(event:cc.Event):void {\r\n        GameManager.eventManager.dispatchEvent(event);\r\n    }\r\n\r\n    /**\r\n     * 携带数据，派发事件\r\n     * \r\n     * @param eventName \r\n     * @param data \r\n     */\r\n    public dispacheEventWith(eventName:string, data:any = null):void {\r\n        GameManager.eventManager.dispatchEventWith(eventName, data);\r\n    }\r\n}\r\n"]}