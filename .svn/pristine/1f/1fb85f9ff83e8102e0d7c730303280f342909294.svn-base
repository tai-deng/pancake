import StateManage from "../StateManage/StateManage";
import GameManager from "../gamecore/managers/GameManager";

const {ccclass, property} = cc._decorator;

@ccclass
export default class TopNavigationBar extends cc.Component {
    /**
     * 顶部导航三个元素
     */
    @property(cc.Node)
    back:cc.Node = null;
    @property(cc.Node)
    grade:cc.Node = null;
    @property(cc.Node)
    score:cc.Node = null;
    @property(cc.Animation)
    animation:cc.Animation=null;

    backHome(){
        cc.director.loadScene("indexSence");
        GameManager.soundsManager.playTapSound();
        console.log("返回!!!!!!")
    }

    onLoad () {
        StateManage.instance.on("change",this.stateChangeHandler,this);
    }

    start () {
        this.back.on(cc.Node.EventType.TOUCH_END,this.backHome,this);
        this.score.getChildByName("Label").getComponent(cc.Label).string = StateManage.instance.getData("gem");
        // cc.log(this.node.name)
    }

    // update (dt) {}
    private stateChangeHandler(e:cc.Event):void {
        let key:string = StateManage.instance.lastChangedKey;
        // 监控钻石
        if (key == StateManage.KEY_GEM) {
            this.score.getChildByName("Label").getComponent(cc.Label).string = StateManage.instance.getData(key);
            if(cc.director.getScene().name == "indexSence"){
                this.animation.play();
            }
        }
    }
}
